# 马尔科夫模型（Markov Models）

本章讨论使用**马尔科夫模型**来从训练数据中学习出函数 $$p$$。

## 定长序列（Fixed-length Sequences）的马尔科夫模型

考虑一个随机变量序列 $$X_1, X_2, ... ,X_n$$ （$$X_i \in \mathcal{V}$$），它的长度 $$n$$ 是一个定值。我们需要计算联合概率 $$P(X_1=x_1, X_2=x_2, ..., X_n=x_n)$$，即任意一个序列 $$x_1, x_2, ... ,x_n$$ 出现的概率。

序列 $$x_1, x_2, ... ,x_n$$ 的所有可能的取值为 $$|\mathcal{V}|^n$$，我们不可能列举出所有  $$|\mathcal{V}|^n$$ 种可能，所以我们需要一个更紧凑的模型。

在一阶马尔科夫过程（First-order Markov Process）中，我们假设每个词的出现概率只依赖于它的前一个词，而与其它词无关：

$$
P(X_1=x_1, X_2=x_2, ..., X_n=x_n)
$$

$$
= P(X_1=x_1) \prod_{i=2}^n P(X_i=x_i | X_1=x_1, ..., X_{i-1}=x_{i-1}) \tag{1.1}
$$

$$
= P(X_1=x_1) \prod_{i=2}^n P(X_i=x_i | X_{i-1}=x_{i-1}) \tag{1.2}
$$

公式 $$1.1$$ 可以由条件概率的链式法则推出，公式 $$1.2$$ 利用了**一阶马尔科夫假设（First-order Markov Assumption）**：第 $$i$$ 个词只依赖于它的前一个词 $$x_{i-1}$$，即对任意 $$i \in \{2 ... n\}$$：

$$
P(X_i=x_i | X_1=x_1, ..., X_{i-1}=x_{i-1}) = P(X_i=x_i | X_{i-1}=x_{i-1})
$$

也即 $$X_i$$ 在给定 $$X_{i-1}$$ 时，条件独立于 $$X_1 ... X_{i-2}$$。